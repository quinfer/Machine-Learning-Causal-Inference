<!DOCTYPE html>
<html lang="en"><head>
<script src="causal_inf_ML_files/libs/clipboard/clipboard.min.js"></script>
<script src="causal_inf_ML_files/libs/quarto-html/tabby.min.js"></script>
<script src="causal_inf_ML_files/libs/quarto-html/popper.min.js"></script>
<script src="causal_inf_ML_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="causal_inf_ML_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="causal_inf_ML_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="causal_inf_ML_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="Barry Quinn">
  <title>Causal inference and machine learning</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="causal_inf_ML_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="causal_inf_ML_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="causal_inf_ML_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="causal_inf_ML_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="causal_inf_ML_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="causal_inf_ML_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="causal_inf_ML_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Causal inference and machine learning</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Barry Quinn 
</div>
</div>
</div>

</section>
<section id="introduction" class="slide level2">
<h2>Introduction</h2>
<ul>
<li>This topic will be split into two</li>
<li>Introduction to supervised learning (another)</li>
<li>How prediction can be deployed into causal inference</li>
</ul>
</section>
<section id="outline-lecture-1" class="slide level2">
<h2>Outline lecture 1</h2>
<ul>
<li>Prediction vs.&nbsp;Causality</li>
<li>Conceptual and practical (python!) intro to supervised machine learning methods</li>
<li>Lasso</li>
<li>Ridge</li>
<li>Elastic nets -Random Forests</li>
</ul>
</section>
<section id="outline-lecture-2" class="slide level2">
<h2>Outline lecture 2</h2>
<ul>
<li>How modern prediction methods can be deployed in the service of causal inference</li>
<li>Post double selection lasso (PDS lasso)</li>
<li>Double/de-biased machine learning (DML) Machine Learning + Causal Inference II (starts May 15)</li>
<li>Predicting heterogeneous treatment effects<br>
</li>
<li>Random Causal Forests Prediction vs.&nbsp;Causality</li>
</ul>
</section>
<section id="prediction-vs.-causality" class="slide level2">
<h2>Prediction vs.&nbsp;Causality</h2>
<ul>
<li>Imagine you are a life insurance underwriter. You receive an application for life insurance from someone with the following characteristics:</li>
<li>male<br>
</li>
<li>age 67</li>
<li>High blood pressure</li>
<li>high cholesterol</li>
<li>family</li>
<li>and . . .</li>
<li>was admitted to the hospital yesterday</li>
</ul>
</section>
<section id="prediction-vs.-causality-1" class="slide level2">
<h2>Prediction vs.&nbsp;Causality</h2>
<ul>
<li>Now imagine you are a loved one of someone with the following characteristics:</li>
<li>and . . .</li>
<li>is having chest pains.</li>
<li>Should you take him to the hospital?</li>
</ul>
</section>
<section id="prediction-vs.-causality-purpose" class="slide level2">
<h2>Prediction vs.&nbsp;Causality: Purpose</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="prepare">Prepare</h3>
<ul>
<li>A loan officer wants to know the likelihood of an individual repaying a loan based on income, employment, and other characteristics.</li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="influence">Influence</h3>
<ul>
<li>A mortgage lender wants to the likelihood of an know if direct debit will individual repaying a loan increase loan repayments based on income, employment, and other characteristics.</li>
</ul>
</div>
</div>
</section>
<section id="prediction-vs.-causality-purpose-1" class="slide level2">
<h2>Prediction vs.&nbsp;Causality: Purpose</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="prepare-1">Prepare</h3>
<ul>
<li>In order to decide whether to invest in a start-up, an investor needs to know how likely the start-up is to succeed, given the entrepreneur’s experience and the characteristics of the industry.</li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="influence-1">Influence</h3>
<ul>
<li>An entrepreneur needs to to invest in a start-up, an know what the effect of investor needs to know how receiving funding from a likely the start-up is to private equity investor succeed, given the (rather than getting a loan) entrepreneur’s experience is on the ultimate success of and the characteristics of an enterprise. the industry.</li>
</ul>
</div>
</div>
</section>
<section id="prediction-vs.-causality-purpose-2" class="slide level2">
<h2>Prediction vs.&nbsp;Causality: Purpose</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="prepare-2">Prepare</h3>
<ul>
<li>A bail hearing judge needs to know how likely a defendant is to flee before trial, given his or her charges, criminal history, and other characteristics Prediction vs.&nbsp;Causality: Purpose Prepare Influence</li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="influence-2">Influence</h3>
<ul>
<li>A policy maker needs to to know how likely a know the effect of being defendant is to flee before released on bail (rather than trial, given his or her detained) prior to trial on charges, criminal history, ultimate conviction and other characteristics</li>
</ul>
</div>
</div>
</section>
<section id="prediction-vs.-causality-purpose-3" class="slide level2">
<h2>Prediction vs.&nbsp;Causality: Purpose</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="prepare-3">Prepare</h3>
<ul>
<li>A home seller wants to know what price homes with the characteristics of his or her home typically sell for</li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="influence-3">Influence</h3>
<ul>
<li>A home seller wants to know what price homes with the by how much installing new characteristics of his or her windows will raise the value home typically sell for of his or her home</li>
</ul>
</div>
</div>
</section>
<section id="prediction-vs.-causality-purpose-4" class="slide level2">
<h2>Prediction vs.&nbsp;Causality: Purpose</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="prepare-4">Prepare</h3>
<ul>
<li>A Harvard admissions officer wants to know how likely an applicant with given credentials is to graduate in 4 years</li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="influence-4">Influence</h3>
<p>A labor economist wants to wants to know how likely an know whether individuals of applicant with given a certain ethnic background credentials is to graduate in are less likely to get into 4 years Harvard than applicants with similar academic credentials</p>
</div>
</div>
</section>
<section id="prediction-vs.-causality-target" class="slide level2">
<h2>Prediction vs.&nbsp;Causality: Target</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><span class="math inline">\(y_i = \alpha + \beta x_i + ε_i\)</span></li>
<li><span class="math inline">\(\beta\)</span> is the slope</li>
<li><span class="math inline">\(\alpha + \beta x_i\)</span> is the prediction</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="causal_inf_ML_files/figure-revealjs/fakeols-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</section>
<section id="prediction-vs.-causality-methods" class="slide level2">
<h2>Prediction vs.&nbsp;Causality: Methods</h2>
<h3 id="causality">Causality</h3>
<ul>
<li><em>:</em> Randomised Control Trails (RCT)</li>
<li><em>Aluminum standard:</em> Regression or IV strategies that approximate controlled experiments</li>
</ul>
</section>
<section id="prediction-vs.-causality-where-shall-they-meet" class="slide level2">
<h2>Prediction vs.&nbsp;Causality: Where shall they meet?</h2>
<p>We’ve seen that prediction and causality</p>
<div>
<ul>
<li class="fragment">answer different questions</li>
<li class="fragment">serve different purposes</li>
<li class="fragment">serve different purposes</li>
<li class="fragment">seek different targets</li>
<li class="fragment">use different methods</li>
<li class="fragment">Different strokes for different folks, or complementary tools in an applied economist’s toolkit?</li>
<li class="fragment">Illustrate using the Oregon Health Insurance Experiment (go to labs)</li>
</ul>
</div>
</section>
<section id="where-ml-fits-into-causal-inference" class="slide level2">
<h2>Where ML fits into causal inference</h2>
<p>Traditional regression strategy: 1. Regress <span class="math inline">\(Y_i\)</span> on <span class="math inline">\(X_i\)</span> and compute the residuals,</p>
<p><span class="math display">\[\tilde{Y_i}=Y_i - \hat{Y}_i^{OLS}\]</span> <span class="math display">\[\hat{Y}_i^{OLS}=X'_i(X'X)^{-1}X'Y\]</span></p>
<ol start="2" type="1">
<li>Regress <span class="math inline">\(D_i\)</span> on <span class="math inline">\(X_i\)</span> and compute the residuals,</li>
</ol>
<p><span class="math display">\[\tilde{D_i}=D_i - \hat{D}_i^{OLS}\]</span></p>
<p><span class="math display">\[\hat{D}_i^{OLS}=X'_i(X'X)^{-1}X'D\]</span></p>
<ol start="3" type="1">
<li>Regress </li>
</ol>
<blockquote>
<p>When OLS might not be the right tool for the job:</p>
</blockquote>
<ul>
<li>there are many variables in <span class="math inline">\(X_i\)</span></li>
<li>the relationship between <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> or <span class="math inline">\(D_i\)</span> may not be linear</li>
</ul>
</section>
<section id="where-ml-fits-into-causal-inference-1" class="slide level2">
<h2>Where ML fits into causal inference</h2>
<p><strong>ML-augmented regression strategy:</strong> 1. Predict <span class="math inline">\(Y_i\)</span> using <span class="math inline">\(Xi\)</span> with ML and compute the residuals, <span class="math display">\[\tilde{Y_i}=Y_i - \hat{Y}_i^{ML}\]</span> <span class="math display">\[\hat{Y}_i^{ML}=\text{ prediction generated by ML}\]</span></p>
<ol start="2" type="1">
<li>Predict <span class="math inline">\(D_i\)</span> using <span class="math inline">\(X_i\)</span> with ML and compute the residuals, <span class="math display">\[\tilde{D_i}=D_i - \hat{D}_i^{ML}\]</span></li>
</ol>
<p><span class="math display">\[\hat{D}_i^{ML}=\text{ prediction generated by ML}\]</span></p>
<ol start="3" type="1">
<li>Regress on .</li>
</ol>
<ul>
<li>Most common ML methods in applied economics: Lasso, Ridge, Elastic net, Random forest</li>
</ul>
</section>
<section id="getting-serious-about-prediction" class="slide level2">
<h2>Getting serious about prediction</h2>
<ul>
<li>Goal: Predict an out-of-sample outcome Y<br>
</li>
<li>as a function, <span class="math inline">\(\hat{f}(X)\)</span>, of features <span class="math inline">\(X=(1,X_1,X_2,...,X_k)\)</span></li>
<li>Estimate the function <span class="math inline">\(\hat{f}\)</span> (aka “train the model”) based on <strong>training sample</strong> <span class="math inline">\(\{ (Y_i,X_i);i=1,...,N\}\)</span></li>
</ul>
</section>
<section id="cutting-our-losses" class="slide level2">
<h2>Cutting our losses</h2>
<ul>
<li><p>Want our prediction to be “close,” i.e.&nbsp;minimize the expected loss function: <span class="math inline">\(\text{min E}[L(f(x)-Y)|X=x]\)</span></p></li>
<li><p>Squared loss: <span class="math inline">\(L(d)=d^2 \implies f^*(x)=E[Y|X=x]\)</span></p></li>
<li><p>Absolute loss: <span class="math inline">\(L(d)=|d| \implies f^*(x)=Med[Y|X=x]\)</span></p></li>
<li><p>Asymmetric loss:</p></li>
</ul>
<p><span class="math display">\[L_{\tau}=d(\tau-1(d&lt;0)) \implies f^*(x)=Q_{1-\tau}[Y|X=x]\]</span></p>
</section>
<section id="navigating-the-bias-variance-tradeoff" class="slide level2">
<h2>Navigating the Bias-Variance Tradeoff</h2>
<ul>
<li>Prediction problem solved if we knew <span class="math inline">\(f^*(x)=E[Y|X=x]\)</span></li>
<li>But we have to settle for an estimate: <span class="math inline">\(\hat{f}\)</span> ;</li>
</ul>
<p><span class="math display">\[E\left[(Y-\hat{f}(x))^2|X=x \right] \text{becomes:}\]</span> - prediction bias squared (under the control of analyst) <span class="math display">\[\left(E\left[\hat{f}(x)-f*(x)\right]^2 \right)\]</span> - prediction variance (under the control of analyst) <span class="math display">\[+ E\left[\left(\hat{f}(x)-E\left[\hat{f}(x)\right]\right)^2\right]\]</span> - irreducible error <span class="math display">\[E\left[\left(Y-f*(x)\right)^2|X=x\right]\]</span></p>
</section>
<section id="navigating-the-bias-variance-tradeoff-1" class="slide level2">
<h2>Navigating the Bias-Variance Tradeoff</h2>
<h3 id="experimental-evidence">Experimental evidence</h3>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1"></a><span class="in">```{r}</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">#| label: fig-low-bias-high-variance</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#| fig-cap: "Low bias, high variance"</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a>n<span class="ot">=</span><span class="dv">40</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">rnorm</span>(n),<span class="at">y=</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="at">sd =</span> <span class="dv">1</span>))<span class="ot">-&gt;</span>df</span>
<span id="cb1-7"><a href="#cb1-7"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,<span class="at">span=</span><span class="fl">0.1</span>,<span class="at">se=</span>F)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-low-bias-high-variance" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="causal_inf_ML_files/figure-revealjs/fig-low-bias-high-variance-1.png" width="960"></p>
<p></p><figcaption>Figure&nbsp;1: Low bias, high variance</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1"></a><span class="in">```{r}</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">#| label: fig-high-bias-low-variance</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#| fig-cap: "High bias, low variance"</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>,<span class="at">span=</span><span class="fl">0.8</span>,<span class="at">se=</span>F)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-high-bias-low-variance" class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="causal_inf_ML_files/figure-revealjs/fig-high-bias-low-variance-1.png" width="960"></p>
<p></p><figcaption>Figure&nbsp;2: High bias, low variance</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="r-example-predicting-earnings-in-the-nlsy" class="slide level2">
<h2>R example: predicting earnings in the NLSY</h2>
<ul>
<li>In Labs/R</li>
</ul>
</section>
<section id="penalized-regression-lasso" class="slide level2 smaller">
<h2>Penalized Regression: Lasso</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="when-is-it-the-right-tool-for-the-job">When is it the right tool for the job:</h3>
<ul>
<li>When you have a large number of potential regressors (including powers or other transformations), maybe even more than the sample size!</li>
<li>Out of these, only a relatively few (but you don’t know which) really matter (what do we mean by “matter?”). We call this <strong>approximate sparsity</strong></li>
<li>Theoretical definition: <span class="math inline">\(\arg \min_{b} \sum_{i=1}^n (y_i-x'_ib)^2+ \lambda \sum_{j=1}^k |b_j|\)</span></li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="caveats-and-considerations">Caveats and considerations:</h3>
<ul>
<li>Important to standardize regressors pre-lasso</li>
<li>Can give unexpected results with dummy variables</li>
<li>Resist the temptation to interpret coefficients or the included variables as the “true model!”</li>
<li>Let’s give it a go in R using Q-RaP!</li>
</ul>
</div>
</div>
</section>
<section id="choosing-tuning-parameters-cross-validation" class="slide level2">
<h2>Choosing Tuning Parameters: Cross-Validation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>All supervised ML methods have tuning parameters</li>
<li>Lasso: <span class="math inline">\(\lambda\)</span></li>
<li>Ridge: <span class="math inline">\(\alpha\)</span></li>
<li>Random forests: tree depth, etc.</li>
<li>Tuning parameters are the <strong>rudder</strong> by which we navigate the bias-variance tradeoff.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="images/tuning_parameters.png"></p>
</div>
</div>
</section>
<section id="choosing-tuning-parameters-cross-validation-1" class="slide level2">
<h2>Choosing Tuning Parameters: Cross-Validation</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="images/k-folds.png"></p>
</div><div class="column" style="width:70%;">
<ol type="1">
<li>Divide sample in K folds</li>
<li>Choose some value of the tuning parameter, <span class="math inline">\(\lambda\)</span></li>
<li>For each fold <span class="math inline">\(k = 1,\dots,K\)</span>
<ol type="1">
<li>Train model leaving out fold k</li>
<li>Generate predictions in fold k</li>
<li>Compute MSE for fold k: <span class="math inline">\(MSE_k=\frac{1}{n_k}\sum_{i \in k}\left(Y_i-\hat{Y}_i\right)^2\)</span></li>
</ol></li>
<li>Compute overall MSE correponding to the current choice of <span class="math inline">\(\lambda: MSE(\lambda)=\frac{1}{K}\sum_{k=1}^K MSE_k\)</span></li>
<li>Repeat the above for many values of λ, and choose the value λ∗ with the lowest cross-validated MSE</li>
</ol>
<p><strong>Your turn</strong></p>
</div>
</div>
</section>
<section id="penalized-regression-ridge" class="slide level2">
<h2>Penalized Regression: Ridge</h2>
<ul>
<li><p>When is it the right tool for the job:</p>
<ul>
<li>When you have a large number of regressors including highly collinear ones</li>
</ul></li>
<li><p>Theoretical definition:</p></li>
</ul>
<p><span class="math display">\[\arg \min_{b}\sum_{i=1}^n \left(y_i-x'_ib\right)^2+\alpha\sum_{j=1}^h
b_j^2\]</span></p>
<ul>
<li>Caveats and considerations: - Important to standardize regressors pre-ridge - Shrinks (biases) coefficients towards zero, but not all the way (unlike lasso)</li>
</ul>
<p>Your Turn</p>
</section>
<section id="penalized-regression-elastic-net" class="slide level2">
<h2>Penalized Regression: Elastic Net</h2>
<ul>
<li><p>Combines lasso and ridge approaches</p></li>
<li><p>Theoretical definition:</p></li>
<li><p>Caveats and considerations: - Two tuning parameters: <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\lambda\)</span> - Important to standardize regressors pre-ridge - Zeros out many regressors, shrinks (biases) remaining coefficients towards zero</p></li>
<li><p>Your turn</p></li>
</ul>
</section>
<section id="decision-trees" class="slide level2">
<h2>Decision Trees</h2>

<img data-src="images/dc1.png" class="r-stretch"></section>
<section id="decision-tree" class="slide level2">
<h2>Decision Tree</h2>

<img data-src="images/dc2.png" class="r-stretch"></section>
<section id="decision-tree-1" class="slide level2">
<h2>Decision Tree</h2>

<img data-src="images/dc3.png" class="r-stretch"></section>
<section id="decision-tree-2" class="slide level2">
<h2>Decision Tree</h2>

<img data-src="images/dc4.png" class="r-stretch"></section>
<section id="decision-tree-3" class="slide level2">
<h2>Decision Tree</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="images/dc5.png"></p>
</div><div class="column" style="width:70%;">
<ul>
<li>Where to split:
<ul>
<li>Choose the feature from <span class="math inline">\(\{ x_1,\dots,x_p \}\)</span> and the value of that feature minimise MSE in the resulting child nodes</li>
</ul></li>
<li>Tuning parameters
<ul>
<li>Max Depth</li>
<li>Min training obs per leaf</li>
<li>Min improvement in fit in order to go ahead with this split</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="forest-for-the-trees" class="slide level2">
<h2>Forest for the Trees</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="images/forest_trees.png"></p>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Value proposition: reduce variance by averaging together multiple predictions</p></li>
<li><p>The catch: individual trees need to be de-correlated</p></li>
<li><p>Algorithm:</p>
<ul>
<li>Grow B trees, each on a different bootstrapped sample</li>
<li>At each split, consider only a random subset of features</li>
<li>Average together the individual predictions</li>
</ul></li>
<li><p>Your turn</p></li>
</ul>
</div>
</div>
</section>
<section id="where-ml-fits-into-causal-inference-recall" class="slide level2">
<h2>Where ML fits into causal inference (Recall)</h2>
<p><strong>ML-augmented regression strategy:</strong></p>
<ol type="1">
<li><p>Predict <span class="math inline">\(Y_i\)</span> using <span class="math inline">\(Xi\)</span> with ML and compute the residuals, <span class="math display">\[\tilde{Y_i}=Y_i - \hat{Y}_i^{ML}\]</span> <span class="math display">\[\hat{Y}_i^{ML}=\text{ prediction generated by ML}\]</span></p></li>
<li><p>Predict <span class="math inline">\(D_i\)</span> using <span class="math inline">\(X_i\)</span> with ML and compute the residuals, <span class="math display">\[\tilde{D_i}=D_i - \hat{D}_i^{ML}\]</span></p></li>
</ol>
<p><span class="math display">\[\hat{D}_i^{ML}=\text{ prediction generated by ML}\]</span></p>
<ol start="3" type="1">
<li>Regress on .</li>
</ol>
<h4 id="two-flavors-of-machine-assisted-causal-inference">Two flavors of machine-assisted causal inference:</h4>
<ol type="1">
<li><p>Post-double selection lasso (PDS lasso), introduced by Belloni, Chernozhukov, and Hansen (2014) (See Readings in repo)</p></li>
<li><p>Double/De-biased machine learning (DML), introduced by Chernozhukov, Chetverikov, Demirer, Duflo, Hansen, Newey, and Robins (2018) (See Readings in repo)</p></li>
</ol>
</section>
<section id="machine-assisted-causal-inference" class="slide level2">
<h2>Machine-Assisted Causal Inference</h2>
<ul>
<li><p>No identification ex machina! Still rely on <span class="math display">\[D_i \models (Y_i(0), Y_i(1)))| X_i\]</span></p></li>
<li><p>What variables to include in <span class="math inline">\(X_i\)</span> ?</p></li>
<li><p>The omitted variables bias formula is our guide. Uncontrolled (bivariate) regression gives us: <span class="math display">\[\hat{\delta}^{bivariate} \to \delta + \beta \frac{Cov(D_i,X_i)}{Var(D_i)}\]</span></p></li>
<li><p>We need to control for variables that</p></li>
<li><p>affect the outcome</p></li>
<li><p>are correlated with treatment</p></li>
<li><p>Beware of <strong>bad control:</strong> including post-treatment variables in <span class="math inline">\(X_i\)</span></p></li>
</ul>
</section>
<section id="pds-lasso-preliminaries" class="slide level2">
<h2>PDS Lasso: Preliminaries</h2>
<ul>
<li><p>Begin with flexible version of our regression model: <span class="math display">\[Y_i = \gamma D_i+g(X_i)+\epsilon_i\]</span></p></li>
<li><p>Approximate the two CEFs, <span class="math display">\[m_D(X_i) \equiv E[D_i|X_i]\]</span> <span class="math display">\[m_D(X_i) \equiv E[D_i|X_i] = \gamma m_D(X_i)+g(X_i)\]</span></p></li>
<li><p>With a sparse linear approximation: <span class="math display">\[m_Y(X_i)=X'_{i,\gamma Y} + r_i\]</span> <span class="math display">\[m_D(X_i)=X'_{i,\gamma D} +s_i\]</span></p></li>
<li><p><span class="math inline">\(X_i\)</span> should contain a dictionary of nonlinear transformations like powers and interactions</p></li>
</ul>
</section>
<section id="pds-lasso-the-recipe" class="slide level2">
<h2>PDS lasso: The Recipe</h2>
<ul>
<li>PDS is implemented in three steps:</li>
</ul>
<ol type="1">
<li>Lasso Yi on Xi , collect retained features in <span class="math inline">\(X^Y_i\)</span></li>
<li>Lasso Di on Xi , collect retained features in <span class="math inline">\(X^D_i\)</span></li>
<li>Regress Yi on Di and <span class="math inline">\(X^Y_i \cup X^D_i\)</span> Caveats and considerations:</li>
</ol>
<ul>
<li>Standardizing controls pre-lasso is important</li>
<li>BCH have a formula for the penalty parameter, but cross-validation seems to work just fine I- Inference: just use robust SEs from last step!</li>
</ul>
</section>
<section id="dml-preliminaries" class="slide level2">
<h2>DML: Preliminaries</h2>
<ul>
<li>Stick with flexible version of our regression model: <span class="math display">\[Y_i=\gamma D_i + g(X_i) + \epsilon_i\]</span></li>
</ul>
<ol type="1">
<li>Predict <span class="math inline">\(Y_i\)</span> using <span class="math inline">\(Xi\)</span> with ML and compute the residuals,</li>
</ol>
<p><span class="math display">\[\tilde{Y_i}=Y_i - \hat{Y}_i^{DML}\]</span></p>
<p><span class="math display">\[\hat{Y}_i^{DML}=\text{ prediction generated by ML}\]</span></p>
<ol start="2" type="1">
<li>Predict <span class="math inline">\(D_i\)</span> using <span class="math inline">\(X_i\)</span> with ML and compute the residuals, <span class="math display">\[\tilde{D_i}=D_i - \hat{D}_i^{DML}\]</span></li>
</ol>
<p><span class="math display">\[\hat{D}_i^{DML}=\text{ prediction generated by ML}\]</span></p>
<ol start="3" type="1">
<li>Regress on .</li>
</ol>
<ul>
<li><span class="math inline">\(\hat{D}_i^{DML}\)</span> and _i^{DML} should be predictions generated by a machine learning model trained on a set of observations that does not include i. We accomplish this via cross-fitting</li>
</ul>
</section>
<section id="dml-recipe" class="slide level2">
<h2>DML: Recipe</h2>
<ol type="1">
<li>Divide the sample into K folds</li>
<li>For k = 1, . . . , K</li>
</ol>
<ul>
<li>Train a model to predict Y given X , leaving out observations i in fold k: ˆY −k (x)</li>
<li>Train a model to predict D given X , leaving out observations i in fold k: ˆD−k (x)</li>
<li>Form residuals ̃Yi = Yi − ˆY −k (Xi ) and ̃Di = Di − ˆD−k (Xi )</li>
</ul>
<ol start="3" type="1">
<li>Regress ̃Yi on ̃Di .</li>
</ol>
<ul>
<li>Caveats and considerations:
<ul>
<li>Cross-validation to choose tuning parameters</li>
<li>Inference: use robust SEs from last step</li>
</ul></li>
</ul>
</section>
<section id="in-conclusion" class="slide level2">
<h2>In Conclusion</h2>
<ul>
<li>Learning outcomes:</li>
<li>Clarity on distinction between predictive and causal questions</li>
<li>Foot in the door with python implementations of some common modern supervised machine learning methods</li>
<li>Tools for using ML methods to control for high dimensional covariates in the service of causal inference Some workshops:</li>
<li>Use ML to predict heterogeneous treatment effects (e.g., random causal forests)</li>
<li>ML and instrumental variables</li>
</ul>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="causal_inf_ML_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="causal_inf_ML_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="causal_inf_ML_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="causal_inf_ML_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="causal_inf_ML_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="causal_inf_ML_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="causal_inf_ML_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="causal_inf_ML_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="causal_inf_ML_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="causal_inf_ML_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>